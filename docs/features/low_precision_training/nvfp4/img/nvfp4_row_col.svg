<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 650 520" width="100%" style="max-width: 650px;">
  <defs>
    <style>
      @import url("../_static/css/diagram-colors.css");
      .title { font: bold 18px sans-serif; fill: #333; text-anchor: middle; }
      .small-text { font: 12px sans-serif; fill: #555; text-anchor: middle; }
      .dots-text { font: bold 24px sans-serif; fill: #333; text-anchor: middle; }
      .fp8-block { fill: #87CEEB; stroke: #555; stroke-width: 1.5; }
      .fp8-block-alt { fill: #5F9FCC; stroke: #555; stroke-width: 1.5; }
      .scale-block { fill: #FFA500; stroke: #555; stroke-width: 1.5; }
      .global-scale { fill: #FF6B00; stroke: #444; stroke-width: 2; }
    </style>
  </defs>

  <!-- ROWWISE SECTION -->
  <text x="325" y="30" class="title">Rowwise (1×16 blocks)</text>
  
  <!-- Rowwise Data [A, B] - 240x120 -->
  <g id="rowwise-tensor">
    <text x="160" y="55" class="small-text">Data [A, B]</text>
    
    <!-- Top-left -->
    <rect x="40" y="70" width="40" height="10" class="fp8-block"/>
    <rect x="80" y="70" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="80" width="40" height="10" class="fp8-block-alt"/>
    <rect x="80" y="80" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="90" width="40" height="10" class="fp8-block"/>
    <rect x="80" y="90" width="40" height="10" class="fp8-block-alt"/>
    
    <!-- Top-right -->
    <rect x="200" y="70" width="40" height="10" class="fp8-block-alt"/>
    <rect x="240" y="70" width="40" height="10" class="fp8-block"/>
    <rect x="200" y="80" width="40" height="10" class="fp8-block"/>
    <rect x="240" y="80" width="40" height="10" class="fp8-block-alt"/>
    <rect x="200" y="90" width="40" height="10" class="fp8-block-alt"/>
    <rect x="240" y="90" width="40" height="10" class="fp8-block"/>
    
    <!-- Bottom-left -->
    <rect x="40" y="160" width="40" height="10" class="fp8-block-alt"/>
    <rect x="80" y="160" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="170" width="40" height="10" class="fp8-block"/>
    <rect x="80" y="170" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="180" width="40" height="10" class="fp8-block-alt"/>
    <rect x="80" y="180" width="40" height="10" class="fp8-block"/>
    
    <!-- Bottom-right -->
    <rect x="200" y="160" width="40" height="10" class="fp8-block"/>
    <rect x="240" y="160" width="40" height="10" class="fp8-block-alt"/>
    <rect x="200" y="170" width="40" height="10" class="fp8-block-alt"/>
    <rect x="240" y="170" width="40" height="10" class="fp8-block"/>
    <rect x="200" y="180" width="40" height="10" class="fp8-block"/>
    <rect x="240" y="180" width="40" height="10" class="fp8-block-alt"/>
    
    <text x="160" y="87" class="dots-text">…</text>
    <text x="160" y="177" class="dots-text">…</text>
    <text x="80" y="135" class="dots-text">⋮</text>
    <text x="240" y="135" class="dots-text">⋮</text>
    
    <rect x="40" y="70" width="240" height="120" fill="none" stroke="#444" stroke-width="2"/>
  </g>
  
  <!-- Rowwise s_block [A, B/16] - 90x120 -->
  <g id="rowwise-scales">
    <text x="425" y="55" class="small-text">s_block [A, B/16]</text>
    
    <!-- Top-left -->
    <rect x="380" y="70" width="10" height="10" class="scale-block"/>
    <rect x="390" y="70" width="10" height="10" class="scale-block"/>
    <rect x="380" y="80" width="10" height="10" class="scale-block"/>
    <rect x="390" y="80" width="10" height="10" class="scale-block"/>
    <rect x="380" y="90" width="10" height="10" class="scale-block"/>
    <rect x="390" y="90" width="10" height="10" class="scale-block"/>
    
    <!-- Top-right -->
    <rect x="450" y="70" width="10" height="10" class="scale-block"/>
    <rect x="460" y="70" width="10" height="10" class="scale-block"/>
    <rect x="450" y="80" width="10" height="10" class="scale-block"/>
    <rect x="460" y="80" width="10" height="10" class="scale-block"/>
    <rect x="450" y="90" width="10" height="10" class="scale-block"/>
    <rect x="460" y="90" width="10" height="10" class="scale-block"/>
    
    <!-- Bottom-left -->
    <rect x="380" y="160" width="10" height="10" class="scale-block"/>
    <rect x="390" y="160" width="10" height="10" class="scale-block"/>
    <rect x="380" y="170" width="10" height="10" class="scale-block"/>
    <rect x="390" y="170" width="10" height="10" class="scale-block"/>
    <rect x="380" y="180" width="10" height="10" class="scale-block"/>
    <rect x="390" y="180" width="10" height="10" class="scale-block"/>
    
    <!-- Bottom-right -->
    <rect x="450" y="160" width="10" height="10" class="scale-block"/>
    <rect x="460" y="160" width="10" height="10" class="scale-block"/>
    <rect x="450" y="170" width="10" height="10" class="scale-block"/>
    <rect x="460" y="170" width="10" height="10" class="scale-block"/>
    <rect x="450" y="180" width="10" height="10" class="scale-block"/>
    <rect x="460" y="180" width="10" height="10" class="scale-block"/>
    
    <text x="425" y="87" class="dots-text">…</text>
    <text x="425" y="177" class="dots-text">…</text>
    <text x="390" y="135" class="dots-text">⋮</text>
    <text x="460" y="135" class="dots-text">⋮</text>
    
    <rect x="380" y="70" width="90" height="120" fill="none" stroke="#444" stroke-width="2"/>
  </g>
  
  <!-- Rowwise s_global -->
  <g id="rowwise-global">
    <text x="545" y="55" class="small-text">s_global</text>
    <rect x="535" y="120" width="20" height="20" class="global-scale"/>
  </g>

  <!-- COLUMNWISE SECTION -->
  <text x="325" y="230" class="title">Columnwise (16×1 blocks) — transposed storage</text>
  
  <!-- Columnwise Data [B, A] - 120x240 (transposed) -->
  <g id="colwise-tensor">
    <text x="100" y="255" class="small-text">Data [B, A]</text>
    
    <!-- Top-left blocks -->
    <rect x="40" y="270" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="280" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="290" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="300" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="310" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="320" width="40" height="10" class="fp8-block-alt"/>
    
    <!-- Top-right blocks -->
    <rect x="120" y="270" width="40" height="10" class="fp8-block-alt"/>
    <rect x="120" y="280" width="40" height="10" class="fp8-block"/>
    <rect x="120" y="290" width="40" height="10" class="fp8-block-alt"/>
    <rect x="120" y="300" width="40" height="10" class="fp8-block"/>
    <rect x="120" y="310" width="40" height="10" class="fp8-block-alt"/>
    <rect x="120" y="320" width="40" height="10" class="fp8-block"/>
    
    <!-- Bottom-left blocks (stick to bottom: box ends at y=510) -->
    <rect x="40" y="450" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="460" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="470" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="480" width="40" height="10" class="fp8-block"/>
    <rect x="40" y="490" width="40" height="10" class="fp8-block-alt"/>
    <rect x="40" y="500" width="40" height="10" class="fp8-block"/>
    
    <!-- Bottom-right blocks -->
    <rect x="120" y="450" width="40" height="10" class="fp8-block"/>
    <rect x="120" y="460" width="40" height="10" class="fp8-block-alt"/>
    <rect x="120" y="470" width="40" height="10" class="fp8-block"/>
    <rect x="120" y="480" width="40" height="10" class="fp8-block-alt"/>
    <rect x="120" y="490" width="40" height="10" class="fp8-block"/>
    <rect x="120" y="500" width="40" height="10" class="fp8-block-alt"/>
    
    <text x="100" y="307" class="dots-text">…</text>
    <text x="100" y="487" class="dots-text">…</text>
    <text x="60" y="395" class="dots-text">⋮</text>
    <text x="140" y="395" class="dots-text">⋮</text>
    
    <rect x="40" y="270" width="120" height="240" fill="none" stroke="#444" stroke-width="2"/>
  </g>
  
  <!-- Columnwise s_block [B, A/16] - 45x240, aligned with rowwise scales at x=380 -->
  <g id="colwise-scales">
    <text x="402" y="255" class="small-text">s_block [B, A/16]</text>
    
    <!-- Top-left -->
    <rect x="380" y="270" width="10" height="10" class="scale-block"/>
    <rect x="380" y="280" width="10" height="10" class="scale-block"/>
    <rect x="380" y="290" width="10" height="10" class="scale-block"/>
    <rect x="380" y="300" width="10" height="10" class="scale-block"/>
    <rect x="380" y="310" width="10" height="10" class="scale-block"/>
    <rect x="380" y="320" width="10" height="10" class="scale-block"/>
    
    <!-- Top-right -->
    <rect x="415" y="270" width="10" height="10" class="scale-block"/>
    <rect x="415" y="280" width="10" height="10" class="scale-block"/>
    <rect x="415" y="290" width="10" height="10" class="scale-block"/>
    <rect x="415" y="300" width="10" height="10" class="scale-block"/>
    <rect x="415" y="310" width="10" height="10" class="scale-block"/>
    <rect x="415" y="320" width="10" height="10" class="scale-block"/>
    
    <!-- Bottom-left -->
    <rect x="380" y="450" width="10" height="10" class="scale-block"/>
    <rect x="380" y="460" width="10" height="10" class="scale-block"/>
    <rect x="380" y="470" width="10" height="10" class="scale-block"/>
    <rect x="380" y="480" width="10" height="10" class="scale-block"/>
    <rect x="380" y="490" width="10" height="10" class="scale-block"/>
    <rect x="380" y="500" width="10" height="10" class="scale-block"/>
    
    <!-- Bottom-right -->
    <rect x="415" y="450" width="10" height="10" class="scale-block"/>
    <rect x="415" y="460" width="10" height="10" class="scale-block"/>
    <rect x="415" y="470" width="10" height="10" class="scale-block"/>
    <rect x="415" y="480" width="10" height="10" class="scale-block"/>
    <rect x="415" y="490" width="10" height="10" class="scale-block"/>
    <rect x="415" y="500" width="10" height="10" class="scale-block"/>
    
    <text x="402" y="307" class="dots-text">…</text>
    <text x="402" y="487" class="dots-text">…</text>
    <text x="387" y="395" class="dots-text">⋮</text>
    <text x="420" y="395" class="dots-text">⋮</text>
    
    <rect x="380" y="270" width="45" height="240" fill="none" stroke="#444" stroke-width="2"/>
  </g>
  
  <!-- Columnwise s_global, aligned with rowwise at x=535 -->
  <g id="colwise-global">
    <text x="545" y="255" class="small-text">s_global</text>
    <rect x="535" y="380" width="20" height="20" class="global-scale"/>
  </g>
</svg>
