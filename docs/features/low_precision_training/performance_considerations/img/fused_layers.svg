<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 850 640" width="850" height="640">
  <defs>
    <style>
      @import url("../_static/css/diagram-colors.css");
      /* Diagram-specific overrides */
      .hp { fill: #f3e5f5; stroke: #7b1fa2; stroke-width: 2.5; }
      .gemm { fill: #ffe8cc; stroke: #f57c00; stroke-width: 3; }
      .quantize { fill: #c8e6c9; stroke: #43a047; stroke-width: 2.5; }
      .text { font-weight: 500; }
      .small-text { fill: #616161; }
      .title { font-weight: 700; fill: #1a1a1a; }
      .arrow { stroke: #424242; stroke-width: 2.5; fill: none; marker-end: url(#arrowhead); }
    </style>
    <marker id="arrowhead" markerWidth="6" markerHeight="6" refX="5" refY="2" orient="auto">
      <polygon points="0 0, 6 2, 0 4" fill="#424242" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="425" y="30" class="title">LayerNorm + Linear: Separate vs Fused</text>
  
  <!-- Divider Line -->
  <line x1="425" y1="50" x2="425" y2="620" stroke="#bdbdbd" stroke-width="2.5" stroke-dasharray="5,5"/>
  
  <!-- LEFT: Separate Layers -->
  <text x="212" y="65" class="section-title">Scenario 1: Separate Layers</text>
  
  <!-- Input -->
  <rect x="137" y="95" width="150" height="55" class="hp" rx="8"/>
  <text x="212" y="128" class="text">Input</text>
  
  <!-- Arrow -->
  <path d="M 212 150 L 212 180" class="arrow"/>
  
  <!-- LayerNorm -->
  <rect x="137" y="180" width="150" height="55" class="layernorm" rx="8"/>
  <text x="212" y="213" class="text" style="font-weight: 600;">LayerNorm</text>
  
  <!-- Arrow -->
  <path d="M 212 235 L 212 260" class="arrow"/>
  
  <!-- Output FP32 -->
  <rect x="147" y="260" width="130" height="50" class="hp" rx="8"/>
  <text x="212" y="290" class="text">Output</text>
  
  <!-- Arrow -->
  <path d="M 212 310 L 212 330" class="arrow"/>
  
  <!-- Linear wrapper -->
  <rect x="122" y="330" width="180" height="190" class="gemm" rx="10"/>
  <text x="212" y="355" class="text" style="font-weight: 600;">Linear</text>
  
  <!-- Quantize inside -->
  <rect x="142" y="368" width="140" height="30" class="quantize" rx="8"/>
  <text x="212" y="388" class="text">Quantize</text>
  
  <!-- Arrow -->
  <path d="M 212 398 L 212 418" class="arrow"/>
  
  <!-- FP8 tensor -->
  <rect x="147" y="418" width="130" height="35" class="fp8" rx="8"/>
  <text x="212" y="441" class="text">FP8 tensor</text>
  
  <!-- Arrow -->
  <path d="M 212 453 L 212 473" class="arrow"/>
  
  <!-- Simplified computation inside -->
  <rect x="142" y="473" width="140" height="30" class="computation" rx="8"/>
  <text x="212" y="493" class="title" style="font-weight: 600;">...</text>
  
  <!-- Arrow out of Linear -->
  <path d="M 212 520 L 212 545" class="arrow"/>
  
  <!-- Output -->
  <rect x="137" y="545" width="150" height="50" class="hp" rx="8"/>
  <text x="212" y="575" class="text">Output</text>
  
  
  <!-- RIGHT: Fused Layer -->
  <text x="637" y="65" class="section-title">Scenario 2: Fused Layer</text>
  
  <!-- Input -->
  <rect x="562" y="95" width="150" height="55" class="hp" rx="8"/>
  <text x="637" y="128" class="text">Input</text>
  
  <!-- Arrow -->
  <path d="M 637 150 L 637 185" class="arrow"/>
  
  <!-- LayerNormLinear Fused -->
  <rect x="517" y="185" width="240" height="220" class="fused" rx="10"/>
  <text x="637" y="212" class="text" style="font-weight: 600;">LayerNormLinear</text>
  
  <!-- Inside fused block -->
  <!-- LayerNorm -->
  <rect x="537" y="235" width="200" height="40" class="layernorm" rx="8"/>
  <text x="637" y="260" class="text">LayerNorm + Quantize</text>
  
  <!-- Arrow -->
  <path d="M 637 275 L 637 295" class="arrow"/>
  
  <!-- FP8 tensor -->
  <rect x="562" y="295" width="150" height="35" class="fp8" rx="8"/>
  <text x="637" y="318" class="text">FP8 tensor</text>
  
  <!-- Arrow -->
  <path d="M 637 330 L 637 350" class="arrow"/>
  
  <!-- Simplified computation -->
  <rect x="567" y="350" width="140" height="35" class="computation" rx="8"/>
  <text x="637" y="373" class="title" style="font-weight: 600;">...</text>
  
  <!-- Arrow out of fused block -->
  <path d="M 637 405 L 637 545" class="arrow"/>
  
  <!-- Output -->
  <rect x="562" y="545" width="150" height="50" class="hp" rx="8"/>
  <text x="637" y="575" class="text">Output</text>
  
</svg>
